% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/coxforest.R
\name{coxforest}
\alias{coxforest}
\title{Create a Forest Plot for Cox Proportional Hazards Models}
\usage{
coxforest(
  model,
  data = NULL,
  title = "Cox Proportional Hazards Model",
  digits = 2,
  font_size = 1,
  annot_size = 3.88,
  header_size = 5.82,
  title_size = 23.28,
  plot_width = NULL,
  plot_height = NULL,
  tbl_width = 0.6,
  col_width_var = 0.01,
  col_width_level = 0.17,
  col_width_n = 0.17,
  col_width_events = 0.06,
  col_width_hr = 0.05,
  show_n_events = c("n", "Events"),
  ref_label = "reference",
  var_labels = NULL,
  color = "#8A61D8"
)
}
\arguments{
\item{model}{A Cox proportional hazards model object of class \code{coxph} 
from the \code{survival} package.}

\item{data}{A data frame or data.table containing the original data used to 
fit the model. If NULL (default), the function attempts to extract data 
from the model object.}

\item{title}{Character string specifying the plot title. Default is "Cox Proportional Hazards Model".}

\item{digits}{Integer specifying the number of decimal places for hazard ratios 
and confidence intervals. Default is 2.}

\item{font_size}{Numeric value controlling the base font size. 
Default is 1.0.}

\item{annot_size}{Numeric value controlling the relative font size for annotations. 
Default is 3.88.}

\item{header_size}{Numeric value controlling the relative font size for headers. 
Default is 5.82.}

\item{title_size}{Numeric value controlling the relative font size for the plot title. 
Default is 23.28.}

\item{plot_width}{Numeric value specifying the intended plot width in inches.
Used to optimize tbl_width calculation. Default is NULL.}

\item{plot_height}{Numeric value specifying the intended plot height in inches.
Default is NULL.}

\item{tbl_width}{Numeric value between 0 and 1 specifying the proportion of plot 
width allocated to the data table. If NULL (default), automatically calculated
based on content and plot dimensions.}

\item{col_width_var}{Numeric value specifying the proportion of plot width 
allocated to the variable column. Default is 0.01.}

\item{col_width_level}{Numeric value specifying the proportion of plot width 
allocated to the group column. Default is 0.17.}

\item{col_width_n}{Numeric value specifying the proportion of plot width 
allocated to the sample size column. Default is 0.17.}

\item{col_width_events}{Numeric value specifying the proportion of plot width 
allocated to the events column. Default is 0.06.}

\item{col_width_hr}{Numeric value specifying the proportion of plot width 
allocated to the hazard ratio column. Default is 0.05.}

\item{ref_label}{Character string to display for reference categories. 
Default is "reference".}

\item{var_labels}{Named character vector for custom variable labels. Names should 
match variable names in the model, values are the display labels.}

\item{color}{Character string specifying the color for hazard ratio point estimates. 
Default is "#8A61D8" (purple).}
}
\value{
A ggplot object containing the forest plot. The object has an attribute
  "recommended_dims" with suggested width and height in inches. If \code{ggpubr} 
  is installed, returns a ggplot object via \code{ggpubr::as_ggplot()}. 
  Otherwise, draws the plot directly and returns it invisibly.
}
\description{
Generates a publication-ready forest plot combining a data table and 
graphical representation of hazard ratios from a Cox proportional hazards model.
The plot includes variable names, group levels, sample sizes, hazard ratios 
with confidence intervals, and p-values.
}
\details{
The function creates a forest plot with the following features:
\itemize{
  \item Alternating row shading by variable groups
  \item Point sizes scaled by sample size
  \item Logarithmic scale for hazard ratios
  \item Model statistics displayed at the bottom (events, global p-value, 
    concordance index with 95% CI, AIC)
  \item Italic formatting for p-values in the display
  \item Automatic calculation of optimal dimensions
  \item Customizable column widths for the data table portion
}

The function will suggest optimal plot dimensions based on the model complexity.
Access these via \code{attr(plot, "recommended_dims")} or note the message output.
}
\examples{
\dontrun{
library(survival)
library(ggplot2)

# Fit a Cox model
cox_model <- coxph(Surv(time, status) ~ age + sex + ph.ecog, data = lung)

# Create forest plot and save with recommended dimensions
p <- coxforest(cox_model)
ggsave("forest.pdf", p, 
       width = attr(p, "recommended_dims")$width,
       height = attr(p, "recommended_dims")$height,
       units = "in")

# Create forest plot with specified dimensions and custom column widths
p <- coxforest(cox_model, 
               title = "Survival Analysis Results",
               plot_width = 12,
               plot_height = 8,
               col_width_var = 0.03,
               col_width_level = 0.20,
               var_labels = c("age" = "Age (years)",
                             "sex" = "Sex",
                             "ph.ecog" = "ECOG Performance Status"))
ggsave("forest.pdf", p, width = 12, height = 8, units = "in")
}

}
\seealso{
\code{\link[survival]{coxph}} for fitting Cox models,
\code{\link[ggplot2]{ggplot}} for the underlying plotting system
}
\author{
Paul H. McClelland <PaulHMcClelland@protonmail.com>
}
